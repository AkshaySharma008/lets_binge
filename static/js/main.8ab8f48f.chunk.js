(this.webpackJsonplets_watch=this.webpackJsonplets_watch||[]).push([[0],{19:function(e,t,n){e.exports={body:"playlist_body__3lUyk",input_message:"playlist_input_message__3Wxxu",message_area:"playlist_message_area__2ibvi",bubble:"playlist_bubble__3zkXk",delete:"playlist_delete__1hF8I",username:"playlist_username__25QZN",message:"playlist_message__mr2ZJ"}},22:function(e,t,n){e.exports={body:"chat_body__-cV2Q",input_message:"chat_input_message__3ShjF",message_area:"chat_message_area__35dwc",bubble:"chat_bubble__GOTsH",username:"chat_username__3goGx",message:"chat_message__1rLmk"}},23:function(e,t,n){e.exports={room_container:"room_room_container__yoafx",wrapper:"room_wrapper__1-jBj",wave:"room_wave__qW0_q",details:"room_details__3Vg9j",options:"room_options__WjL6V",nav_active:"room_nav_active__2WXXR"}},26:function(e,t,n){e.exports={body:"members_body__2jUfz",message_area:"members_message_area__2bAad",bubble:"members_bubble__2ltKc",delete:"members_delete__3hP2I",message:"members_message__hP31-"}},34:function(e,t,n){e.exports={shadow:"page_loader_shadow__3rt0p",title:"page_loader_title__2Udzc"}},37:function(e,t,n){e.exports={player:"player_player__7Avdx",react_player:"player_react_player__iHCin"}},51:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(42),s=n.n(c),o=(n(51),n(17)),i=n(6),u=n(5),l=n.n(u),b=n(13),d=n(31),m=(n(87),n(54),{ALLOWED_DOMAINS:["music.youtube.com","youtube.com"],CONVERT_DOMAINS:{"music.youtube.com":"youtube.com"},DEFAULT_SRC:"https://www.youtube.com/watch?v=7bv_eqtkKqQ",FIREBASE:{API_KEY:"AIzaSyCMrTjeCVqbWIUDuXSzrQCCWOO1UuNbJBM",AUTH_DOMAIN:"orbital-scene-200115.firebaseapp.com",PROJECT_ID:"orbital-scene-200115",STORAGE_BUCKET:"orbital-scene-200115.appspot.com",MESSAGING_SENDER_ID:"184642334250",APP_ID:"1:184642334250:web:bc19551df971fb77b25d53",MEASUREMENT_ID:"G-WG9CW377SK"},USERNAME_KEY:"username",EVENT:{ADD:{KEYWORD:"add",MESSAGE:["Say Hi to ${user}","${user} is here!","Look ${user} is here"]},REMOVE:{KEYWORD:"remove",MESSAGE:["${user} left"]},MESSAGE:{KEYWORD:"message"},LOAD:{KEYWORD:"load",MESSAGE:["${user} has loaded another video"]},PLAYER:{PLAY:{KEYWORD:"play",MESSAGE:["${user} started playing!"]},PAUSE:{KEYWORD:"pause",MESSAGE:["${user} paused the video!"]}}}}),p=m.FIREBASE,f="rooms",j="members",O=function(){d.a.initializeApp({apiKey:p.API_KEY,authDomain:p.AUTH_DOMAIN,projectId:p.PROJECT_ID,storageBucket:p.STORAGE_BUCKET,messagingSenderId:p.MESSAGING_SENDER_ID,appId:p.APP_ID,measurementId:p.MEASUREMENT_ID})},E=function(){return 0===d.a.apps.length&&O(),d.a.firestore()},v={initializeFirebase:O,createRoom:function(){var e=Object(b.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=E(),e.next=3,t.collection(f).add({name:"Demo Room",playlist:[m.DEFAULT_SRC]});case 3:return n=e.sent,e.abrupt("return",n.id);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),createMember:function(){var e=Object(b.a)(l.a.mark((function e(t,n,a){var r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=E(),e.next=3,r.collection(f).doc(t).collection(j).add({name:n,isHost:a});case 3:return c=e.sent,e.abrupt("return",c.id);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),rooms:function(){return E().collection("rooms")},createEvent:function(){var e=Object(b.a)(l.a.mark((function e(t,n,a,r){var c,s,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=E(),s=new Date,o=s.getTime(),e.next=5,c.collection(f).doc(t).collection("events").add({type:n,user:a,message:r,createdAt:o});case 5:return i=e.sent,e.abrupt("return",i.id);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),events:function(e){return E().collection("rooms").doc(e).collection("events").orderBy("createdAt")},members:function(e){return E().collection("rooms").doc(e).collection("members")},getLastEvents:function(){var e=Object(b.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E(),a=n.collection("rooms").doc(t).collection("events"),e.next=4,a.limit(25).get();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getMembers:function(){var e=Object(b.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E(),a=n.collection(f).doc(t).collection(j),e.next=4,a.get();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),findMember:function(){var e=Object(b.a)(l.a.mark((function e(t,n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=E(),r=a.collection(f).doc(n).collection(j),e.next=4,r.doc(t).get();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),updateRoomDetails:function(e,t,n,a){return E().collection(f).doc(e).update({url:t,progress:n,playlist:a}).id},getARoom:function(){var e=Object(b.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E(),a=n.collection(f).doc(t),e.next=4,a.get();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updatePlaylist:function(e,t){return E().collection(f).doc(t).update({playlist:e}).id}},h=n(34),_=n.n(h),g=n(44),x=n.n(g),y=n(2);var S=function(e){var t=e.title,n=e.cover,a={backgroundImage:"linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), \n        url(".concat(n,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"};return Object(y.jsxs)("div",{className:_.a.shadow,style:a,children:[Object(y.jsx)("div",{className:_.a.title,children:t}),Object(y.jsx)(x.a,{loading:!0,css:"\n    position:fixed;\n    left: 45%;\n    top: 50%;\n",size:100,color:"white"})]})},A=function(){var e=Object(i.g)(),t=Object(a.useState)(!1),n=Object(o.a)(t,2),r=n[0],c=n[1];return Object(y.jsxs)("div",{children:[r&&Object(y.jsx)(S,{title:"Creating Room"}),Object(y.jsx)("div",{children:Object(y.jsx)("button",{onClick:function(){c(!0),v.createRoom().then((function(t){!function(t){t&&e.push({pathname:"/room",search:"?track=".concat(t)})}(t)})).catch((function(e){c(!1)}))},children:"Create Room"})})]})},N=n(12),R=n(46),D=n.n(R),w=n(37),k=n.n(w);var C=function(e){var t=e.src,n=e.createEvent,r=e.playing,c=e.updateRoomProgress,s=e.seek,o=e.playListAction,i=Object(a.useRef)(),u=m.EVENT.PLAYER;Object(a.useEffect)((function(){return function(){}}));var l=function(){console.log("Ended!!!"),o(2)};Object(a.useEffect)((function(){s&&i.current.seekTo(s,"fraction")}),[s]);var b={youtube:{playerVars:{showinfo:0,autoplay:0},events:{onStateChange:l}},facebook:{appId:"12345"}};return Object(y.jsx)("div",{className:k.a.player,children:Object(y.jsx)(D.a,{url:t,ref:i,playing:r,className:k.a.react_player,loop:!1,width:"100%",height:"100%",config:b,controls:!0,onPause:function(){!0===r&&n(u.PAUSE.KEYWORD)},onBuffer:function(){console.log("Bufferringgg!!")},onSeek:function(){console.log("Seekingg")},onPlay:function(){!1===r&&n(u.PLAY.KEYWORD)},onEnded:l,onProgress:function(e){c(e.played)}})})},M=n(22),L=n.n(M);var P=function(e){var t=e.messages,n=e.addMessage,r=Object(a.useRef)();Object(a.useEffect)((function(){return function(){}})),Object(a.useEffect)((function(){r.current.scrollIntoView()}),[t]);var c=function(){var e=document.getElementById("msg"),t=e.value;t&&(n(t),e.value="")};return Object(y.jsxs)("div",{className:L.a.body,children:[Object(y.jsxs)("div",{className:L.a.message_area,children:[t&&t.map((function(e,t){return Object(y.jsxs)("div",{className:L.a.bubble,children:[e.username&&Object(y.jsxs)("div",{className:L.a.username,children:[e.username,":"]}),Object(y.jsx)("div",{className:L.a.message,children:e.message})]},t)})),Object(y.jsx)("span",{ref:r})]}),Object(y.jsxs)("div",{className:L.a.input_message,children:[Object(y.jsx)("input",{onKeyPress:function(e){13===e.which&&c()},type:"text",id:"msg",placeholder:"Say Hi!"}),Object(y.jsx)("button",{onClick:c,children:"SEND"})]})]})},I=n(19),T=n.n(I);var Y=function(e){var t=e.playlist,n=e.playListAction,r=Object(a.useRef)();Object(a.useEffect)((function(){return function(){}})),Object(a.useEffect)((function(){r.current.scrollIntoView()}),[t]);var c=function(){var e=document.getElementById("url"),t=e.value;t&&(n(1,t),e.value="")};return Object(y.jsxs)("div",{className:T.a.body,children:[Object(y.jsxs)("div",{className:T.a.message_area,children:[t&&t.map((function(e,t){return Object(y.jsxs)("div",{className:T.a.bubble,children:[e.username&&Object(y.jsxs)("div",{className:T.a.username,children:[e.username,":"]}),Object(y.jsx)("div",{className:T.a.message,children:e.url}),Object(y.jsx)("p",{className:T.a.delete,onClick:function(){!function(e){n(3,"",!1,e)}(t)},children:"Delete"})]},t)})),Object(y.jsx)("span",{ref:r})]}),Object(y.jsxs)("div",{className:T.a.input_message,children:[Object(y.jsx)("input",{onKeyPress:function(e){13===e.which&&c()},type:"text",id:"url",placeholder:"DROP YOUR LINK HERE"}),Object(y.jsx)("button",{onClick:function(){var e=document.getElementById("url"),t=e.value;t&&(n(0,t,!0),e.value="")},children:"LOAD"}),Object(y.jsx)("button",{id:"playlist",onClick:c,children:"Add to PlayList"})]})]})},K=n(26),V=n.n(K);var W=function(e){var t=e.members;return Object(a.useRef)(),Object(a.useEffect)((function(){t=Object(N.a)(new Set(t))}),[t]),Object(y.jsx)("div",{className:V.a.body,children:Object(y.jsx)("div",{className:V.a.message_area,children:t&&t.map((function(e,t){return Object(y.jsxs)("div",{className:V.a.bubble,children:[e.username&&Object(y.jsxs)("div",{className:V.a.username,children:[e.username,":"]}),Object(y.jsx)("div",{className:V.a.message,children:"".concat(e.name," ").concat(e.isHost?" [Host]":"")})]},t)}))})})},U=n(23),G=n.n(U),B=n(24),H=function(e,t){"object"===typeof t&&null!==t?B.reactLocalStorage.setObject(e,t):B.reactLocalStorage.set(e,t)},F=function(e){if(e){var t=B.reactLocalStorage.getObject(e);return"object"===typeof t&&0!==Object.keys(t).length?t:B.reactLocalStorage.get(e)}return null},z=new Map;var $=function(){var e=Object(i.h)(),t=Object(a.useState)(m.DEFAULT_SRC),n=Object(o.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)("USER"),u=Object(o.a)(s,2),d=u[0],p=u[1],f=Object(a.useState)(0),j=Object(o.a)(f,2),O=j[0],E=j[1],h=Object(a.useState)(!1),_=Object(o.a)(h,2),g=_[0],x=_[1],S=Object(a.useState)(0),A=Object(o.a)(S,2),R=A[0],D=A[1],w=Object(a.useState)([]),k=Object(o.a)(w,2),M=k[0],L=k[1],I=Object(a.useState)([]),T=Object(o.a)(I,2),K=T[0],V=T[1],U=Object(a.useState)([]),B=Object(o.a)(U,2),$=B[0],J=B[1],q=Object(a.useState)(null),Q=Object(o.a)(q,2),X=Q[0],Z=Q[1],ee=Object(a.useState)(null),te=Object(o.a)(ee,2),ne=te[0],ae=te[1],re=function(e){var t=function(e){for(var t="",n=0;n<m.ALLOWED_DOMAINS.length;n++){var a=m.ALLOWED_DOMAINS[n];if(e.includes(a)){t=a;break}}if(""===t)return-1;var r=t;return m.CONVERT_DOMAINS[t]&&(r=m.CONVERT_DOMAINS[t]),[t,r]}(e=e.trim());return Array.isArray(t)?e.replace(t[0],t[1]):e},ce=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=re(e);c(n),v.createEvent(X,m.EVENT.LOAD.KEYWORD,ne,n),t&&(K.shift(),K.unshift({url:e,username:le(),userId:ne}),V(Object(N.a)(K)))},se=function(e){re(e)&&(K.push({url:e,username:le(),userId:ne}),1!==K.length||r||ce(e),V(Object(N.a)(K)))},oe=function(){if(K.length>0)if(K[0].url===r&&K.shift(),K.length>0){var e=K[0];ce(e.url)}else c(void 0),Ee(1);V(Object(N.a)(K))},ie=function(e){K[e].url===r&&oe(),K=K.filter((function(t,n){return n!==e})),V(Object(N.a)(K))},ue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;switch(e){case 0:ce(t,n);break;case 1:se(t);break;case 2:oe();break;case 3:ie(a)}v.updatePlaylist(K,X)},le=function(){var e=m.USERNAME_KEY,t=F(e);return t||(t=prompt("Enter Username"),H(e,t),t)},be=function(){var e=Object(b.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getMembers(X);case 2:e.sent.forEach((function(e){z.set(e.id,e.data()),$.push({id:e.id,name:e.data().name,isHost:e.data().isHost})})),$=Object(N.a)(new Set($)),J(Object(N.a)($));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=Object(b.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=F(X))||!n.member){e.next=6;break}ne=n.member,ae(ne),e.next=17;break;case 6:return a=0===z.size,e.next=9,v.createMember(X,t,a);case 9:ne=e.sent,ae(ne),H(X,{member:ne}),z.set(ne,{name:t,isHost:a}),$.push({id:ne,name:d,isHost:a}),$=Object(N.a)(new Set($)),J(Object(N.a)($));case 17:v.createEvent(X,m.EVENT.ADD.KEYWORD,ne,"");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(b.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(a=null===(n=z.get(t))||void 0===n?void 0:n.name)){e.next=7;break}return e.next=4,v.findMember(t,X);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=a;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(b.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getARoom(X);case 2:(t=e.sent)&&((n=t.data()).url&&c(n.url),n.progress&&D(n.progress),n.playlist?(K=n.playlist,V(Object(N.a)(K))):n.url?(K=[n.url],V(Object(N.a)(K))):V([]));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(e,t){var n=e.length;return e[Math.floor(Math.random()*n)].replace("${user}",t)},je=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"dummy";1===e?0===$.filter((function(e){return e.id===t})).length&&$.push({id:t,name:n}):2===e&&($=$.filter((function(e){return e.id!==t}))),$=$.filter((function(e,t,n){return n.indexOf(e)==t})),$=Object(N.a)(new Set($)),J(Object(N.a)($))},Oe=function(){var e=Object(b.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.user,e.next=3,me(n);case 3:a=e.sent,e.t0=t.type,e.next=e.t0===m.EVENT.ADD.KEYWORD?7:e.t0===m.EVENT.REMOVE.KEYWORD?10:e.t0===m.EVENT.LOAD.KEYWORD?13:e.t0===m.EVENT.MESSAGE.KEYWORD?16:e.t0===m.EVENT.PLAYER.PLAY.KEYWORD?18:e.t0===m.EVENT.PLAYER.PAUSE.KEYWORD?21:23;break;case 7:return je(1,n,a),e.abrupt("return",{message:fe(m.EVENT.ADD.MESSAGE,a)});case 10:return je(2,n,a),e.abrupt("return",{message:fe(m.EVENT.REMOVE.MESSAGE,a)});case 13:return c(t.message),e.abrupt("return",{message:fe(m.EVENT.LOAD.MESSAGE,a)});case 16:return e.abrupt("return",{message:t.message,username:a});case 18:return x(!0),e.abrupt("return",{message:fe(m.EVENT.PLAYER.PLAY.MESSAGE,a)});case 21:return x(!1),e.abrupt("return",{message:fe(m.EVENT.PLAYER.PAUSE.MESSAGE,a)});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(e){var t;(null===z||void 0===z||null===(t=z.get(ne))||void 0===t?void 0:t.isHost)&&v.updateRoomDetails(X,r,e,K)},ve=[{key:"Chat",component:Object(y.jsx)(P,{className:"chat",messages:M,addMessage:function(e){v.createEvent(X,m.EVENT.MESSAGE.KEYWORD,ne,e)}})},{key:"PlayList",component:Object(y.jsx)(Y,{className:"chat",playlist:K,loadMedia:ce,appendToPlaylist:se,mediaEnd:oe,playListAction:ue,setPlaylist:V})},{key:"Members",component:Object(y.jsx)(W,{members:$})}];return Object(a.useEffect)((function(){!function(){var t=e.search,n=new URLSearchParams(t).get("track");Z(X=n)}(),pe();var t=le();return p(t),be().then((function(e){de(t).then((function(e){v.events(X).onSnapshot((function(e){var t=[];e.docChanges().forEach((function(e){t.push(new Promise((function(t,n){var a;null===(a=Oe(e.doc.data()))||void 0===a||a.then((function(e){t(e)})).catch((function(e){n(e)}))})))})),Promise.all(t).then((function(e){M=M.concat(e),L(M)}))}))}))})),function(){v.createEvent(X,m.EVENT.REMOVE.KEYWORD,ne,"")}}),[]),Object(y.jsxs)("div",{className:G.a.room_container,children:[Object(y.jsx)("nav",{className:G.a.options,children:ve.map((function(e,t){return Object(y.jsx)("a",{className:"".concat(O===t?G.a.nav_active:""),onClick:function(){E(t)},children:e.key})}))}),Object(y.jsxs)("div",{className:G.a.wrapper,children:[Object(y.jsx)(C,{className:"player",src:r,createEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";v.createEvent(X,e,ne,t)},playing:g,updateRoomProgress:Ee,playListAction:ue,seek:R}),ve[O].component]}),Object(y.jsx)("div",{className:G.a.details,children:Object(y.jsx)("button",{onClick:pe,children:"RE-SYNC"})}),Object(y.jsx)("div",{className:G.a.wave,children:Object(y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1440 320",children:Object(y.jsx)("path",{fill:"#641ba8cc",fillP:"1",d:"M0,128L24,133.3C48,139,96,149,144,144C192,139,240,117,288,128C336,139,384,181,432,186.7C480,192,528,160,576,170.7C624,181,672,235,720,256C768,277,816,267,864,272C912,277,960,299,1008,266.7C1056,235,1104,149,1152,112C1200,75,1248,85,1296,101.3C1344,117,1392,139,1416,149.3L1440,160L1440,320L1416,320C1392,320,1344,320,1296,320C1248,320,1200,320,1152,320C1104,320,1056,320,1008,320C960,320,912,320,864,320C816,320,768,320,720,320C672,320,624,320,576,320C528,320,480,320,432,320C384,320,336,320,288,320C240,320,192,320,144,320C96,320,48,320,24,320L0,320Z"})})})]})},J=n(28);var q=function(){return Object(y.jsx)("div",{className:"App",children:Object(y.jsx)(J.a,{children:Object(y.jsxs)(i.d,{children:[Object(y.jsx)(i.b,{exact:!0,path:"/",component:A}),Object(y.jsx)(i.b,{path:"/room",component:$}),Object(y.jsx)(i.a,{to:"/"})]})})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,88)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(y.jsx)(r.a.StrictMode,{children:Object(y.jsx)(q,{})}),document.getElementById("root")),Q()}},[[85,1,2]]]);
//# sourceMappingURL=main.8ab8f48f.chunk.js.map